# _WebcamDS_ReleaseObjectsBRAVE
======== Func _WebcamDS_EnumerateDevices($CLSID_category, $argument = 99)     $oDevEnum = ObjCreateInterface($sCLSID_SystemDeviceEnum, $sIID_ICreateDevEnum, $tagICreateDevEnum)      If Not IsObj($oDevEnum) Then Return SetError(6, 0, 0)     Local $pEnum = 0     $oDevEnum.CreateClassEnumerator($CLSID_category, $pEnum, 0)     $oEnum = ObjCreateInterface($pEnum, $sIID_IEnumMoniker, $tagIEnumMoniker)      If Not IsObj($oEnum) Then Return SetError(7, 0, 0)     Local $iPosition = '', $arg = ''     If StringInStr($CLSID_category, "860bb310") Or StringInStr($CLSID_category, "33d9a762") Then         $iPosition = $argument         $arg = ''     Else         $iPosition = ''         $arg = $argument     EndIf     Local $pMoniker, $oMoniker, $hr     Local $i = 1, $pBindObj[99]     While $oEnum.Next(1, $pMoniker, 0) = $S_OK         Local $pPropBag, $oPropBag         $oMoniker = ObjCreateInterface($pMoniker, $sIID_IMoniker, $tagIMoniker)         If Not IsObj($oMoniker) Then Return SetError(8, 0, 0)         $hr = $oMoniker.BindToObject(0, 0, $sIID_IBaseFilter, $pBindObj[$i])         If $hr &lt; 0 Then ExitLoop         $hr = $oMoniker.BindToStorage(0, 0, $sIID_IPropertyBag, $pPropBag)         If $hr &lt; 0 Then Return SetError(1, 2, 0)         $oPropBag = ObjCreateInterface($pPropBag, $sIID_IPropertyBag, $tagIPropertyBag)         If Not IsObj($oPropBag) Then Return SetError(9, 0, 0)         Local $var = ''         $hr = $oPropBag.Read("FriendlyName", $var, 0)         If $hr &lt; 0 Then Return SetError(1, 3, 0)         If $iPosition = 99 Then             If $var &lt;> '' Then                 $aWebcamList[$i] = $var             EndIf             Local $oCaptureTemp = ObjCreateInterface($pBindObj[$i], $sIID_IBaseFilter, $tagIBaseFilter)             $oCaptureTemp = 0         EndIf         If ($iPosition &lt;> '' And $iPosition = $i) Or ($arg &lt;> '' And $var = $arg) Then             If ($iPosition &lt;> '' And $iPosition = $i) Then                 If Not IsObj($oCapture[$iPosition]) Then                     $oCapture[$iPosition] = ObjCreateInterface($pBindObj[$i], $sIID_IBaseFilter, $tagIBaseFilter)                     If Not IsObj($oCapture[$iPosition]) Then Return SetError(12, 0, 0)                 EndIf                 $hr = $oGraph.AddFilter($oCapture[$iPosition], "CaptureFilter" &amp; $iWebcam)                 If $hr &lt; 0 Then Return SetError(1, 6, 0)                 WinSetTitle($hGUI, '', $var)                 ExitLoop             EndIf         EndIf         $oPropBag = 0         $i += 1     WEnd     If $iPosition = 99 And StringInStr($CLSID_category, "860bb310") Then $aWebcamList[0] = $i - 1     $oMoniker = 0     $oEnum = 0     $oDevEnum = 0 EndFunc   ;==>_WebcamDS_EnumerateDevices  Func _WebcamDS_Reset()     _WebcamDS_ReleaseObjects()     _WebcamDS_Init() EndFunc   ;==>_WebcamDS_Reset ; #INTERNAL_NO_DOC# 
